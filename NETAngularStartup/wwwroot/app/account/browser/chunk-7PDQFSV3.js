import{a as T,b as xe,c as k,d as M,j as A,n as be,o as Ce,p as Ie}from"./chunk-UGIHCGVM.js";import{a as ye}from"./chunk-TOYSTB67.js";import{a as he}from"./chunk-QWIGCCEX.js";import{a as ue}from"./chunk-6NY67VQD.js";import{a as ge,c as fe}from"./chunk-IPHKMWFL.js";import{C as me,E as R,G as _e,M as ve,g as te,m as ie,t as ae,v as se}from"./chunk-IQZ6UM2A.js";import{$ as _,$a as $,Ba as r,Bb as C,Cb as L,Db as U,Ec as S,Fc as pe,Ha as N,Ia as F,La as v,Oa as s,Ob as X,Qb as K,Rb as Y,S as x,T as w,Vb as J,Wb as q,Xa as n,Xb as Z,Y as Q,Ya as o,Za as p,_a as z,bb as b,c as P,db as h,eb as d,fc as ee,ha as g,hc as ne,ia as u,jc as oe,kc as re,mc as E,pb as m,pc as de,qb as V,rb as I,sb as B,sc as le,tb as j,ub as G,vb as H,wc as ce,xb as W,za as D}from"./chunk-EURR6JOP.js";import{a as f,b as O}from"./chunk-WWX6BADO.js";var Me=i=>[i];function we(i,t){i&1&&(n(0,"div"),p(1,"app-norecord",1),o()),i&2&&(r(),s("message","Access Restricted"))}function De(i,t){if(i&1){let e=b();n(0,"tr"),p(1,"td"),n(2,"td"),p(3,"div",16),o(),n(4,"td")(5,"span",17),m(6),C(7,"date"),o()(),n(8,"td")(9,"div",18)(10,"div",19),p(11,"i",20),o(),n(12,"ul",21)(13,"li")(14,"a",22),p(15,"i",23),m(16," View Detail"),o()(),n(17,"li")(18,"a",24),h("click",function(a){let l=g(e).$implicit;return d(7).deleteRecord(l,a),u(!1)}),p(19,"i",25),m(20," Delete"),o()()()()()()}if(i&2){let e=t.$implicit;r(3),s("innerHTML",e.description,D),r(3),I(" ",U(7,3,e.created_at,"fullDate")," "),r(8),s("routerLink",W(6,Me,"/logs/profile/"+e.id))}}function Le(i,t){if(i&1){let e=b();n(0,"div",9)(1,"table",10)(2,"thead")(3,"tr"),p(4,"th",11),n(5,"th"),m(6," Description "),o(),n(7,"th"),m(8," Date "),o(),n(9,"th",12),m(10," Action "),o()()(),n(11,"tbody"),v(12,De,21,8,"tr",13),o()(),n(13,"div",14)(14,"pagination",15),C(15,"async"),h("OnSelection",function(a){g(e);let l=d(6);return u(l.paginationSelection(a))}),o()()()}if(i&2){let e,c=d().ngIf,a=d(5);r(12),s("ngForOf",c)("ngForTrackBy",a.getKey),r(2),s("currentPage",a.navQuery.pagenumber)("totalRecords",(e=L(15,5,a.records$))!==null&&e!==void 0?e:0)("pageSize",a.navQuery.pagesize)}}function Ue(i,t){if(i&1&&(n(0,"div"),p(1,"app-norecord",1),o()),i&2){let e=d(6);r(),s("message",e.NoRecordText)}}function Re(i,t){if(i&1&&(z(0),v(1,Le,16,7,"div",8)(2,Ue,2,1,"div",0),$()),i&2){let e=t.ngIf;r(),s("ngIf",e.length>0),r(),s("ngIf",e.length===0)}}function Te(i,t){if(i&1){let e=b();n(0,"div")(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"input",5),G("ngModelChange",function(a){g(e);let l=d(4);return j(l.navQuery.term,a)||(l.navQuery.term=a),u(a)}),h("keyup.enter",function(a){g(e);let l=d(4);return u(l.searchRecords(a))}),o()(),p(6,"div",6),o(),n(7,"div",7),v(8,Re,3,2,"ng-container",0),C(9,"async"),o()()()()}if(i&2){let e=d(4);r(5),B("ngModel",e.navQuery.term),r(3),s("ngIf",L(9,2,e.data$))}}function ke(i,t){i&1&&p(0,"app-loader")}function Ae(i,t){if(i&1&&(n(0,"div")(1,"div",28)(2,"div",34)(3,"div",2)(4,"div",3)(5,"h4",35),m(6),o(),n(7,"p",36),m(8),C(9,"date"),o(),n(10,"p"),m(11),o(),n(12,"div",37)(13,"h5"),m(14,"Description"),o(),p(15,"hr")(16,"div",16),o()()()()()()),i&2){let e=d(5);r(6),V(e.selectedDocument.url),r(2),I(" Submitted: ",U(9,4,e.selectedDocument.created_at,"fullDate")," "),r(3),I(" ",e.selectedDocument.description," "),r(5),s("innerHTML",e.selectedDocument.stack_trace,D)}}function Oe(i,t){if(i&1){let e=b();n(0,"div")(1,"div",26)(2,"button",27),h("click",function(a){g(e);let l=d(4);return u(l.back(a))}),m(3," Back to Listing "),o()(),n(4,"div",28)(5,"div",29)(6,"div",2)(7,"div",3)(8,"div",30)(9,"div",31)(10,"a",32),h("click",function(a){return g(e),d(4).navAction("delete","Delete Blog Post","Are you sure you want to delete this blog post?",a),u(!1)}),n(11,"span"),m(12,"Delete"),o()()()()()()(),n(13,"div",33),v(14,ke,1,0,"app-loader",0)(15,Ae,17,7,"div",0),o()()()}if(i&2){let e=d(4);r(14),s("ngIf",e.showLoader),r(),s("ngIf",!e.showLoader)}}function Pe(i,t){if(i&1&&(n(0,"div"),v(1,Te,10,4,"div",0)(2,Oe,16,2,"div",0),o()),i&2){let e=d(3);r(),s("ngIf",e.pageIndex==="_INDEX_"),r(),s("ngIf",e.pageIndex==="_PROFILE_")}}function Qe(i,t){if(i&1&&(n(0,"div"),p(1,"app-norecord",1),o()),i&2){let e=d(3);r(),s("message",e.errorMessage)}}function Ne(i,t){if(i&1&&(n(0,"div"),v(1,Pe,3,2,"div",0)(2,Qe,2,1,"div",0),o()),i&2){let e=d(2);r(),s("ngIf",e.errorMessage===""),r(),s("ngIf",e.errorMessage!=="")}}function Fe(i,t){if(i&1&&(n(0,"div"),v(1,we,2,1,"div",0)(2,Ne,3,2,"div",0),o()),i&2){let e=d();r(),s("ngIf",!e.pageRole.admin),r(),s("ngIf",e.pageRole.admin&&e.pageInit)}}var y=class i{store=_(te);logService=_(k);route=_(ne);router=_(oe);coreService=_(me);titleService=_(ee);appConfig=_(se);modalService=_(fe);location=_(X);auth$=this.store.select(ae);config$=this.store.select(ve);loading$=this.store.select(Ce);data$=this.store.select(be);records$=this.store.select(Ie);navQuery=f({},T);isAuthenticated=!1;User=f({},R);selectedDocument=f({},xe);Tags=[];configs=[];pageRole=_e;navButton="Find Records";pageIndex="_INDEX_";errorMessage="";pageInit=!1;showLoader=!1;NoRecordText="No Records Found!";submitButtonText="Submit";headingTitle="Add Post";controls=[];destroy$=new P;ngOnInit(){this.initializeAuthSubscription()}initializeAuthSubscription(){this.auth$.pipe(x(this.destroy$),w(t=>{t.length>0&&t[0].isAuthenticated&&(this.isAuthenticated=!0,this.User=t[0].User??f({},R),this.pageRole=this.coreService.processRole(t[0].Role||[]),this.loadAppConfigs())})).subscribe()}loadAppConfigs(){this.config$.pipe(x(this.destroy$),w(t=>{t.length>0&&(this.configs=t,this.navQuery.pagesize=this.configs[0].configs.settings.general.pageSize,this.initializeRouteListener())})).subscribe()}initializeRouteListener(){this.route.params.pipe(x(this.destroy$)).subscribe(t=>{this.coreService.bindParams(this.navQuery,t),this.initializeRouteData()})}initializeRouteData(){let t=this.route.snapshot.firstChild?.data||this.route.snapshot.data;t.key&&(this.pageIndex=t.key),t.title&&this.titleService.setTitle(`${t.title} - ${this.appConfig.getConfig("title")}`),this.initializePage(),this.pageInit=!0}initializePage(){switch(this.pageIndex){case"_INDEX_":this.initializeManageListings();break;case"_CREATE_":case"_UPDATE_":this.initializeCreateUpdate();break;case"_PROFILE_":this.initializeProfile();break;default:this.handleUnknownPage();break}}initializeManageListings(){this.store.dispatch(M({Query:this.navQuery}))}initializeCreateUpdate(){if(this.navQuery.id!==0&&(this.navQuery.id=parseInt(this.coreService.decrypt(this.navQuery.id?.toString()),10)),this.pageIndex==="_UPDATE_"&&!this.navQuery.id){this.errorMessage="Missing record information";return}this.headingTitle=this.pageIndex==="_UPDATE_"?"Update Post":"Create Post",this.pageIndex==="_UPDATE_"?this.navQuery.id?this.loadDocument(this.navQuery.id):this.errorMessage="Invalid record ID":this.initializeControls()}initializeProfile(){if(this.navQuery.id!==0&&(this.navQuery.id=parseInt(this.coreService.decrypt(this.navQuery.id?.toString()),10)),!this.navQuery.id){this.errorMessage="Invalid record ID";return}this.loadDocument(this.navQuery.id)}handleUnknownPage(){this.errorMessage=`Unknown page: ${this.pageIndex}`}loadDocument(t){this.showLoader=!0,this.logService.GetInfo(O(f({},T),{id:t})).pipe(x(this.destroy$)).subscribe({next:e=>{e.status==="error"?this.showNotification(e.message??"Unknown error","danger"):e.record&&this.handleDocumentResponse(e.record),this.showLoader=!1},error:e=>{this.showNotification("Failed to load document","danger"),this.showLoader=!1}})}handleDocumentResponse(t){this.selectedDocument=t,this.pageIndex==="_PROFILE_"||this.initializeControls()}initializeControls(){}showNotification(t,e){this.store.dispatch(ie({title:t,text:"",css:`bg-${e}`}))}searchRecords(t){this.navQuery.pagenumber=1,this.store.dispatch(M({Query:this.navQuery}))}paginationSelection(t){this.navQuery.pagenumber=t,this.store.dispatch(M({Query:this.navQuery}))}toolbarAction(t){switch(t){case"add":this.router.navigate(["/blogs/create-post"]);break;case"categories":this.router.navigate(["/categories/2"]);break}}deleteRecord(t,e){this.openConfirmationDialog("Delete Record","Are you sure you want to delete selected record",()=>{this.store.dispatch(A({Entities:[t],actionstatus:"delete"}))},e)}navAction(t,e,c,a){this.openConfirmationDialog(e,c,()=>{this.store.dispatch(A({Entities:[this.selectedDocument],actionstatus:t})),t==="delete"&&this.router.navigate(["/logs"])},a)}openConfirmationDialog(t,e,c,a){a.stopPropagation();let l=this.modalService.open(he,{backdrop:!1});l.componentInstance.Info={title:t,message:e},l.result.then(()=>c(),()=>console.log("Dialog dismissed"))}back(t){t.stopPropagation(),this.location.back()}getKey(t,e){return e.id}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=N({type:i,selectors:[["app-main-log"]],features:[H([k])],decls:1,vars:1,consts:[[4,"ngIf"],[3,"message"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between"],["type","text","placeholder","Search ...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"d-flex"],[1,"mt-4","mb-4"],["class","table-responsive",4,"ngIf"],[1,"table-responsive"],[1,"table","align-middle","mb-0"],[2,"width","5px"],[1,"text-nowrap"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-cent","mt-3"],[3,"OnSelection","currentPage","totalRecords","pageSize"],[3,"innerHTML"],[1,"text-muted"],[1,"dropdown","options","ms-auto"],["data-bs-toggle","dropdown",1,"dropdown-toggle","dropdown-toggle-nocaret"],[1,"bx","bx-dots-horizontal-rounded"],[1,"dropdown-menu"],[1,"dropdown-item",3,"routerLink"],[1,"bx","bx-note"],["href","javascript:;",1,"dropdown-item",3,"click"],[1,"bx","bx-trash"],[1,"mb-3"],[1,"btn","btn-secondary","me-1",3,"click"],[1,"row"],[1,"col-12","col-lg-3"],[1,"fm-menu"],[1,"list-group","list-group-flush"],["href","javascript:;",1,"list-group-item","py-1",3,"click"],[1,"col-12","col-lg-9"],[1,"col-md-12"],[1,"card-title"],[1,"mb-2"],[1,"border","border-3","p-4","rounded","mb-3"]],template:function(e,c){e&1&&v(0,Fe,3,2,"div",0),e&2&&s("ngIf",c.isAuthenticated)},dependencies:[Y,K,J,q,E,re,S,de,le,ce,ge,ue,ye],encapsulation:2})};var ze=[{path:"",data:{title:"Manage Logs",breadcrumb:[{label:"Dashboard",url:"/"},{label:"Logs",url:""}]},component:y},{path:"profile/:id",data:{key:"_PROFILE_",title:"Detail Log",breadcrumb:[{label:"Dashboard",url:"/"},{label:"Logs",url:""}]},component:y}],Ee=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=F({type:i});static \u0275inj=Q({imports:[Z,S,pe,E.forChild(ze),y]})};export{Ee as MainErrorLogModule};
