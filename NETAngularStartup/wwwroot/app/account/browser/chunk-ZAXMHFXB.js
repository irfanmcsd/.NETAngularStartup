import{a as A,b as ve,c as Q,d as M,j as N,n as ue,o as he,p as fe}from"./chunk-B5FT6SXW.js";import{a as ge}from"./chunk-TOYSTB67.js";import{a as me}from"./chunk-QWIGCCEX.js";import{a as ce,c as _e}from"./chunk-IPHKMWFL.js";import{C as de,E as D,G as le,M as pe,g as q,m as Z,t as ie,v as ne}from"./chunk-IQZ6UM2A.js";import{$ as m,$a as C,Ba as a,Bb as E,Cb as R,Ec as I,Fc as se,Ha as z,Ia as F,La as _,Oa as r,Ob as j,Qb as B,Rb as H,S as u,Sb as W,T as w,Tb as X,Vb as K,Xa as o,Xb as Y,Y as k,Ya as n,Za as g,_a as y,bb as b,c as U,db as T,eb as d,fc as J,ha as h,hc as ee,ia as f,jc as te,mc as S,pb as l,pc as oe,qb as P,sb as $,sc as ae,tb as L,ub as V,vb as G,wc as re}from"./chunk-EURR6JOP.js";import{a as v,b as O}from"./chunk-WWX6BADO.js";function xe(i,t){i&1&&(o(0,"div"),g(1,"app-norecord",1),n()),i&2&&(a(),r("message","Access Restricted"))}function be(i,t){i&1&&(o(0,"span",25),l(1," High "),n())}function Te(i,t){i&1&&(o(0,"span",26),l(1," Medium "),n())}function Se(i,t){i&1&&(o(0,"span",27),l(1," Low "),n())}function Ie(i,t){i&1&&(o(0,"span",25),l(1," User Searches "),n())}function Me(i,t){i&1&&(o(0,"span",25),l(1," Active "),n())}function we(i,t){i&1&&(o(0,"span",27),l(1," Inactive "),n())}function Ee(i,t){if(i&1){let e=b();o(0,"tr")(1,"td"),l(2),n(),o(3,"td"),y(4,15),_(5,be,2,0,"span",16)(6,Te,2,0,"span",17)(7,Se,2,0,"span",18),C(),y(8,15),_(9,Ie,2,0,"span",16),C(),n(),o(10,"td"),y(11,15),_(12,Me,2,0,"span",16)(13,we,2,0,"span",18),C(),n(),o(14,"td")(15,"div",19)(16,"div",20),g(17,"i",21),n(),o(18,"ul",22)(19,"li")(20,"a",23),T("click",function(s){let c=h(e).$implicit;return d(7).deleteRecord(c,s),f(!1)}),g(21,"i",24),l(22," Delete"),n()()()()()()}if(i&2){let e=t.$implicit;a(2),P(e.title),a(2),r("ngSwitch",e.tag_level),a(),r("ngSwitchCase",0),a(),r("ngSwitchCase",1),a(),r("ngSwitchCase",2),a(),r("ngSwitch",e.tag_type),a(),r("ngSwitchCase",1),a(2),r("ngSwitch",e.isenabled),a(),r("ngSwitchCase",1),a(),r("ngSwitchCase",0)}}function Re(i,t){if(i&1){let e=b();o(0,"div",9)(1,"table",10)(2,"thead")(3,"tr")(4,"th"),l(5,"Title"),n(),o(6,"th"),l(7,"Type"),n(),o(8,"th"),l(9,"Status"),n(),o(10,"th",11),l(11,"Action"),n()()(),o(12,"tbody"),_(13,Ee,23,10,"tr",12),n()(),o(14,"div",13)(15,"pagination",14),E(16,"async"),T("OnSelection",function(s){h(e);let c=d(6);return f(c.paginationSelection(s))}),n()()()}if(i&2){let e,p=d().ngIf,s=d(5);a(13),r("ngForOf",p)("ngForTrackBy",s.getKey),a(2),r("currentPage",s.navQuery.pagenumber)("totalRecords",(e=R(16,5,s.records$))!==null&&e!==void 0?e:0)("pageSize",s.navQuery.pagesize)}}function De(i,t){if(i&1&&(o(0,"div"),g(1,"app-norecord",1),n()),i&2){let e=d(6);a(),r("message",e.NoRecordText)}}function Ae(i,t){if(i&1&&(y(0),_(1,Re,17,7,"div",8)(2,De,2,1,"div",0),C()),i&2){let e=t.ngIf;a(),r("ngIf",e.length>0),a(),r("ngIf",e.length===0)}}function Qe(i,t){if(i&1){let e=b();o(0,"div")(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"input",5),V("ngModelChange",function(s){h(e);let c=d(4);return L(c.navQuery.term,s)||(c.navQuery.term=s),f(s)}),T("keyup.enter",function(s){h(e);let c=d(4);return f(c.searchRecords(s))}),n()(),g(6,"div",6),n(),o(7,"div",7),_(8,Ae,3,2,"ng-container",0),E(9,"async"),n()()()()}if(i&2){let e=d(4);a(5),$("ngModel",e.navQuery.term),a(3),r("ngIf",R(9,2,e.data$))}}function Ne(i,t){if(i&1&&(o(0,"div"),_(1,Qe,10,4,"div",0),n()),i&2){let e=d(3);a(),r("ngIf",e.pageIndex==="_INDEX_")}}function Oe(i,t){if(i&1&&(o(0,"div"),g(1,"app-norecord",1),n()),i&2){let e=d(3);a(),r("message",e.errorMessage)}}function Ue(i,t){if(i&1&&(o(0,"div"),_(1,Ne,2,1,"div",0)(2,Oe,2,1,"div",0),n()),i&2){let e=d(2);a(),r("ngIf",e.errorMessage===""),a(),r("ngIf",e.errorMessage!=="")}}function ke(i,t){if(i&1&&(o(0,"div"),_(1,xe,2,1,"div",0)(2,Ue,3,2,"div",0),n()),i&2){let e=d();a(),r("ngIf",!e.pageRole.admin),a(),r("ngIf",e.pageRole.admin&&e.pageInit)}}var x=class i{store=m(q);tagService=m(Q);route=m(ee);router=m(te);coreService=m(de);titleService=m(J);appConfig=m(ne);modalService=m(_e);location=m(j);auth$=this.store.select(ie);config$=this.store.select(pe);loading$=this.store.select(he);data$=this.store.select(ue);records$=this.store.select(fe);navQuery=v({},A);isAuthenticated=!1;User=v({},D);selectedDocument=v({},ve);configs=[];pageRole=le;navButton="Find Records";pageIndex="_INDEX_";errorMessage="";pageInit=!1;showLoader=!1;NoRecordText="No Records Found!";destroy$=new U;ngOnInit(){this.initializeAuthSubscription()}initializeAuthSubscription(){this.auth$.pipe(u(this.destroy$),w(t=>{t.length>0&&t[0].isAuthenticated&&(this.isAuthenticated=!0,this.User=t[0].User??v({},D),this.pageRole=this.coreService.processRole(t[0].Role||[]),this.loadAppConfigs())})).subscribe()}loadAppConfigs(){this.config$.pipe(u(this.destroy$),w(t=>{t.length>0&&(this.configs=t,this.navQuery.pagesize=this.configs[0].configs.settings.general.pageSize,this.initializeRouteListener())})).subscribe()}initializeRouteListener(){this.route.params.pipe(u(this.destroy$)).subscribe(t=>{this.coreService.bindParams(this.navQuery,t),this.initializeRouteData()})}initializeRouteData(){let t=this.route.snapshot.firstChild?.data||this.route.snapshot.data;t.key&&(this.pageIndex=t.key),t.title&&this.titleService.setTitle(`${t.title} - ${this.appConfig.getConfig("title")}`),this.initializePage(),this.pageInit=!0}initializePage(){switch(this.pageIndex){case"_INDEX_":this.initializeManageListings();break;case"_CREATE_":case"_UPDATE_":this.initializeCreateUpdate();break;case"_PROFILE_":this.initializeProfile();break;default:this.handleUnknownPage();break}}initializeManageListings(){this.store.dispatch(M({Query:this.navQuery}))}initializeCreateUpdate(){if(this.navQuery.id!==0&&(this.navQuery.id=parseInt(this.coreService.decrypt(this.navQuery.id?.toString()),10)),this.pageIndex==="_UPDATE_"&&!this.navQuery.id){this.errorMessage="Missing record information";return}this.pageIndex==="_UPDATE_"?this.navQuery.id?this.loadDocument(this.navQuery.id):this.errorMessage="Invalid record ID":this.initializeControls()}initializeProfile(){if(this.navQuery.id!==0&&(this.navQuery.id=parseInt(this.coreService.decrypt(this.navQuery.id?.toString()),10)),!this.navQuery.id){this.errorMessage="Invalid record ID";return}this.loadDocument(this.navQuery.id)}handleUnknownPage(){this.errorMessage=`Unknown page: ${this.pageIndex}`}loadDocument(t){this.showLoader=!0,this.tagService.GetInfo(O(v({},A),{id:t})).pipe(u(this.destroy$)).subscribe({next:e=>{e.status==="error"?this.showNotification(e.message??"Unknown error","danger"):e.record&&this.handleDocumentResponse(e.record),this.showLoader=!1},error:e=>{this.showNotification("Failed to load document","danger"),this.showLoader=!1}})}handleDocumentResponse(t){this.selectedDocument=t,this.pageIndex==="_PROFILE_"||this.initializeControls()}initializeControls(){}showNotification(t,e){this.store.dispatch(Z({title:t,text:"",css:`bg-${e}`}))}searchRecords(t){this.navQuery.pagenumber=1,this.store.dispatch(M({Query:this.navQuery}))}paginationSelection(t){this.navQuery.pagenumber=t,this.store.dispatch(M({Query:this.navQuery}))}toolbarAction(t){switch(t){case"add":break}}deleteRecord(t,e){this.openConfirmationDialog("Delete Record","Are you sure you want to delete selected record",()=>{this.store.dispatch(N({Entities:[t],actionstatus:"delete"}))},e)}navAction(t,e,p,s){this.openConfirmationDialog(e,p,()=>{this.store.dispatch(N({Entities:[this.selectedDocument],actionstatus:t})),t==="delete"&&this.router.navigate(["/blogs"])},s)}openConfirmationDialog(t,e,p,s){s.stopPropagation();let c=this.modalService.open(me,{backdrop:!1});c.componentInstance.Info={title:t,message:e},c.result.then(()=>p(),()=>console.log("Dialog dismissed"))}back(t){t.stopPropagation(),this.location.back()}getKey(t,e){return e.id}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=z({type:i,selectors:[["app-main-tags"]],features:[G([Q])],decls:1,vars:1,consts:[[4,"ngIf"],[3,"message"],[1,"card"],[1,"card-body"],[1,"d-flex","justify-content-between"],["type","text","placeholder","Search tags...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"d-flex"],[1,"mt-4","mb-4"],["class","table-responsive",4,"ngIf"],[1,"table-responsive"],[1,"table","align-middle","mb-0"],[1,"text-nowrap"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"d-flex","justify-content-cent","mt-3"],[3,"OnSelection","currentPage","totalRecords","pageSize"],[3,"ngSwitch"],["class","badge rounded-pill bg-light-success text-success",4,"ngSwitchCase"],["class","badge rounded-pill bg-light-warning text-warning",4,"ngSwitchCase"],["class","badge rounded-pill bg-light-danger text-danger",4,"ngSwitchCase"],[1,"dropdown","options","ms-auto"],["data-bs-toggle","dropdown",1,"dropdown-toggle","dropdown-toggle-nocaret"],[1,"bx","bx-dots-horizontal-rounded"],[1,"dropdown-menu"],["href","javascript:;",1,"dropdown-item",3,"click"],[1,"bx","bx-trash"],[1,"badge","rounded-pill","bg-light-success","text-success"],[1,"badge","rounded-pill","bg-light-warning","text-warning"],[1,"badge","rounded-pill","bg-light-danger","text-danger"]],template:function(e,p){e&1&&_(0,ke,3,2,"div",0),e&2&&r("ngIf",p.isAuthenticated)},dependencies:[H,B,W,X,K,S,I,oe,ae,re,ce,ge],encapsulation:2})};var ze=[{path:"",data:{title:"Manage Tags",breadcrumb:[{label:"Dashboard",url:"/"},{label:"Tags",url:""}]},component:x}],ye=class i{static \u0275fac=function(e){return new(e||i)};static \u0275mod=F({type:i});static \u0275inj=k({imports:[Y,I,se,S.forChild(ze),x]})};export{ye as MainTagModule};
